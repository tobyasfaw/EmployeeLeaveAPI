# Focus Backend Engineer Exercises

Recommended approach:

- For each exercise, create a pull request (PR) and merge your PR into main for your repository

Both exercises involve implementing code and then verifying that the written test cases pass as expected.

All tests are located in `test_backend_engineer_interview.py`

## Structure

```
backend-engineer-interview/
  backend_engineer_interview/
    app.py
    handlers.py - Routes should be implemented here
    models.py - Database models, new models should be added here
  tests/
    test_backend_engineer_interview.py - Test cases for the exercises
  app.db - initialized sqlite db
  openapi.yaml - Open API specifications
```

## Setup Instructions

1. Install python@3.9.7. This can be managed with [asdf](https://github.com/asdf-vm/asdf) and [asdf-python](https://github.com/danhper/asdf-python)
2. Install [poetry](https://python-poetry.org/docs/#osx--linux--bashonwindows-install-instructions)
3. Run `poetry config virtualenvs.in-project true`
4. Run `poetry install --no-root`. Installing the dependencies will take a few minutes.
5. Run `poetry run python -m backend_engineer_interview` to bring up the API server

## Exercises

All the exercises have existing test cases written to verify that the code is working as expected

## 1. Implement a GET employee endpoint

### Acceptance Criteria

- As a user I would like to retrieve a user by ID with fields:
  - id
  - first_name
  - last_name
  - date_of_birtth
- I should not be able to see the employee's secret
- If the ID does not exist in the DB, I expect to receive a 404

### Implementation Notes

- `flask.jsonify` and `from_orm` can convert a model into a JSON response
- There is already a db context that can be used

## 2. Implement a PATCH employee endpoint

### Acceptance Criteria

- As a user, I should be able to patch and employees first and last name
- As a user, I should recieve a 400 if I try to set the first or last name to an empty string
- As a user, I should receive a 404 if the ID of the employee to patch does not exist

### Implementation Notes

- The API definition `openapi.yaml` needs to be edited. It maps python functions to an enpodint via `operationId`. For an example, look at the provided `/v1/status` endpoint.
- The schema definition can provide some validation of the request and the response

## 3. Implement a POST application endpoint

### Acceptance Criteria

- As a user, I should be able to POST a new application with the following fields
  - leave_start_date
  - leave_end_date
  - the ID of an employee
- I should receive a 400 if the POST body is invalid
  - Missing fields
  - Employee ID does not exist

### Implementation Notes

- The Request and Response schema should get defined first in `openapi.yaml`
- A new model will need to be created for the new table; more instructions on the DB are found in the FAQ
- The new model should have a foreign key relationship to employee

## FAQ

- How do I reset the database?

  Delete the app.db file and run `poetry run alembic upgrade head`

- What URL are the docs at?

  http://localhost:1550/v1/docs

- How do I see an example response?

  If you would like to see the example response generated from the open API definition. Simply comment out `operationId`.

- How do I create new tables from models?

  New tables can be generated by running `poetry run alembic revision --autogenerate -m "Revision name"` and then `poetry run alembic upgrade head`

### Pair Programming Exercise Instructions

Implement `handlers.split_start_end_dates`. Use the test cases in `TestSplitDates` to verify your work. The exercise is complete when they all pass.
